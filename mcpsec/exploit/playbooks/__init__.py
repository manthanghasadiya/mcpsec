"""
Exploitation playbooks for different vulnerability classes.
"""

from dataclasses import dataclass, field
from typing import List, Optional, Any

@dataclass
class PayloadEntry:
    payload: Any
    description: str

@dataclass
class ExploitStage:
    name: str                               # e.g. "boundary_testing"
    description: str                        # "Test basic traversal patterns"
    payloads: List[PayloadEntry]            # Static payload list
    success_indicators: List[str]           # Regex/string substrings that confirm success
    failure_indicators: List[str]           # Substrings that mean "blocked/filtered"
    next_stage_on_success: Optional[str]    # Which stage to advance to
    ai_escalation_prompt: str = ""          # Extra context for AI if enabled

@dataclass
class Playbook:
    vuln_type: str                          # "path_traversal", "sqli", etc.
    stages: List[ExploitStage]              # Ordered stages
    description: str = ""

from .path_traversal import path_traversal_playbook
from .sqli import sqli_playbook
from .command_injection import command_injection_playbook
from .prompt_injection import prompt_injection_playbook
from .ssrf import ssrf_playbook
from .sandbox_escape import sandbox_escape_playbook
from .generic import generic_playbook

PLAYBOOKS = {
    "path_traversal": path_traversal_playbook,
    "sqli": sqli_playbook,
    "command_injection": command_injection_playbook,
    "prompt_injection": prompt_injection_playbook,
    "ssrf": ssrf_playbook,
    "sandbox_escape": sandbox_escape_playbook,
    "generic": generic_playbook
}


