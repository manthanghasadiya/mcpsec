rules:
  - id: mcp-secrets-in-code
    message: >
      Hardcoded secret detected. API keys and tokens should not be committed.
    severity: ERROR
    languages: [typescript, javascript, python, go]
    patterns:
      - pattern-either:
        - pattern-regex: "(?i)(api_key|access_token|secret_key|private_key|auth_token)\\s*[:=]\\s*['\"][a-zA-Z0-9_\\-]{20,}['\"]"
        - pattern-regex: "(?i)(password|passwd|pwd)\\s*[:=]\\s*['\"][a-zA-Z0-9_\\-!@#$%^&*]{8,}['\"]"
        - pattern-regex: "(?i)AI_API_KEY\\s*[:=]\\s*['\"][a-zA-Z0-9_\\-]{20,}['\"]"
        - pattern-regex: "sk-[a-zA-Z0-9]{48}"
        - pattern-regex: "xox[baprs]-([0-9a-zA-Z]{10,48})"
        - pattern-regex: "-----BEGIN (RSA|EC|DSA|OPENSSH) PRIVATE KEY-----"
    metadata:
      cwe: CWE-798
      category: secrets-exposure
      confidence: MEDIUM
